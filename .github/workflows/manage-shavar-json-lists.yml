name: Run script on shavar-creation-lists
on: workflow_dispatch

jobs:
  build:
    runs-on: ubuntu-latest
    strategy:
      max-parallel: 4
      matrix:
        python-version: [3.7]
    steps:
    - uses: actions/checkout@v2
      with:
        persist-credentials: false 
        token: ${{ secrets.GITHUB_TOKEN }}
    - name: Set up Python ${{ matrix.python-version }}
      uses: actions/setup-python@v1
      with:
        python-version: ${{ matrix.python-version }}
    - name: Install dependencies
      run: |
        python -m pip install --upgrade pip
        pip install -r requirements.txt
    - uses: actions/checkout@v3
      with:
        repository: 'mozilla-services/shavar-list-creation'
        ref: 'creat-json-tracking-protection-lists'
    - name: Modify and run the script
      run: |
        ls
        mv sample_shavar_list_creation.ini shavar_list_creation.ini

        sed -i -e 's/sample_shavar_list_creation.ini/shavar_list_creation.ini/g' lists2safebrowsing.py

        python3 ./lists2safebrowsing.py

